<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../polymer/lib/elements/dom-if.html">
<link rel="import" href="../fs-person-chip/fs-person-chip.html">
<link rel="import" href="../paper-card/paper-card.html">
<link rel="import" href="../paper-fab/paper-fab.html">
<link rel="import" href="../iron-icons/iron-icons.html">

<!--
    
@customElement
@polymer
@demo demo/index.html
-->
<dom-module id="fs-pedigree-couple">
  <template>
    <style>
      :host {
        display: block;
      }
      
      paper-card {
        width: 100%;
        height: 100%;
      }
      
      fs-person-chip:last-of-type {
        margin-top: 8px;
      }
      
      paper-fab {
        position: absolute;
        right: -55px;
        top: calc(50% - 20px);
        --paper-fab-background: #fff;
        --paper-fab-iron-icon: {
          color: #333;
        }
      }
      
    </style>
    <paper-card>
      <div class="card-content">
        <template is="dom-if" if="{{husband}}">
          <fs-person-chip client-name="[[clientName]]" person="[[husband]]"></fs-person-chip>
        </template>
        <template is="dom-if" if="{{wife}}">
          <fs-person-chip client-name="[[clientName]]" person="[[wife]]"></fs-person-chip>
        </template>
      </div>
    </paper-card>
    <template is="dom-if" if="{{extend}}">
      <paper-fab mini icon="chevron-right" on-click="_extendEvent"></paper-fab>
    </template>
  </template>
  <script>
    class FsPedigreeCouple extends FSApiAwareMixin(Polymer.Element) {
  
      static get is() { return 'fs-pedigree-couple'; }
      
      static get properties() {
        return {
          husband: Object,
          wife: Object,
          
          /**
           * Whether to show the button to extend the pedgree from this couple
           */
          extend: {
            type: Boolean,
            value: false
          }
        };
      }
      
      /**
       * Fired when the extend button is clicked.
       *
       * @event extend-couple
       * @param {{husbandId:string}} ID of the husband.
       * @param {{wifeId:string}} ID of the wife.
       */
      _extendEvent() {
        this.dispatchEvent(new CustomEvent('extend-couple', {
          detail: {
            husbandId: this.husband ? this.husband.id : undefined,
            wifeId: this.wife ? this.wife.id : undefined,
            x: this.style.left,
            y: this.style.top
          },
          // We want this event to go through the ancestor group and be caught
          // by the pedigree so we set bubbles and composed to true.
          bubbles: true,
          composed: true
        }));
      }
      
    }
    
    customElements.define(FsPedigreeCouple.is, FsPedigreeCouple);
  </script>
</dom-module>
