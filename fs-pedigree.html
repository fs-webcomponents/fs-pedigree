<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../fs-api-aware/fs-api-aware.html">
<link rel="import" href="fs-pedigree-ancestor-group.html">

<!--
Display a FamilySearch person's pedigree.

    <fs-pedigree person-id="PPPP-PPP"></fs-pedigree>
    
@customElement
@polymer
@demo demo/index.html
-->
<dom-module id="fs-pedigree">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>
    <div id="groups"></div>
  </template>

  <script>
    class FsPedigree extends FSApiAwareMixin(Polymer.Element) {
  
      static get is() { return 'fs-pedigree'; }
      
      /**
       * Fired when a person is tapped. The event details will contain the same
       * details as a click event with an added `personId` property.
       *
       * @event person-tap
       * @param {{personId:string}} ID of the person that was clicked.
       */
      
      static get properties() {
        return {
          
          /** ID of the root person */
          personId: {
            type: String
          },
          
          /** 
           * ID of the root person's spouse, if known. When not specified, the
           * API will automatically choose a spouse. You may set this property
           * to specify which spouse will be loaded.
           */
          spouseId: {
            type: String,
            value: ''
          },
          
          /** Whether to show the "+ Add Person" buttons in the pedigree when a person is missing */
          addPersons: {
            type: Boolean,
            value: false
          }
        };
      }
      
      ready() {
        super.ready();
        
        // Start setup by appending the root group
        const group = new FsPedigreeAncestorGroup();
        group.personId = this.personId;
        group.spouseId = this.spouseId;
        group.root = true;
        group.clientName = this.clientName;
        this.$.groups.appendChild(group);
      }
      
      reload() {
        // TODO: How will this be done?
        // this.$.request.generateRequest();
      }
      
    }
    
    customElements.define(FsPedigree.is, FsPedigree);
  </script>
</dom-module>
